<p-dialog
  [header]="dialogTitle"
  [modal]="true"
  [visible]="visible()"
  (visibleChange)="onHide()"
  [style]="{ width: '25vw'}"
  [draggable]="false"
  [resizable]="false">

  <form (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
    @if (errorMessage()) {
      <p-message severity="error" [text]="errorMessage()!" styleClass="w-full" />
    }

    <!-- Account Name -->
    <div class="flex flex-col gap-2">
      <label for="name" class="font-medium text-color">
        Account Name <span class="text-red-500">*</span>
      </label>
      <input
        pInputText
        id="name"
        [(ngModel)]="formData.name"
        name="name"
        placeholder="e.g., Chase Checking"
        class="w-full"
        maxlength="100"
        required
      />
    </div>

    <!-- Account Type -->
    <div class="flex flex-col gap-2">
      <label for="type" class="font-medium text-color">
        Account Type <span class="text-red-500">*</span>
      </label>
      <p-select
        id="type"
        [(ngModel)]="formData.type"
        name="type"
        appendTo="body"
        scrollHeight="180px"
        [options]="accountTypes"
        optionLabel="label"
        optionValue="value"
        placeholder="Select account type"
        styleClass="w-full"
        required>
        <ng-template let-option pTemplate="item">
          <div class="flex items-center gap-2">
            <i [class]="'pi ' + option.icon"></i>
            <span>{{ option.label }}</span>
          </div>
        </ng-template>

        <ng-template let-option pTemplate="selectedItem">
          @if (option) {
          <div class="flex items-center gap-2">
            <i [class]="'pi ' + option.icon"></i>
            <span>{{ option.label }}</span>
          </div>
          }
          @else {
          <span class="text-muted-color">Select account type</span>
          }
        </ng-template>
      </p-select>
    </div>

    <!-- Current Balance -->
    <div class="flex flex-col gap-2">
      <label for="balance" class="font-medium text-color">
        Current Balance <span class="text-red-500">*</span>
      </label>
      <p-inputNumber
        id="balance"
        [(ngModel)]="formData.currentBalance"
        name="balance"
        mode="currency"
        currency="USD"
        locale="en-US"
        [minFractionDigits]="2"
        [maxFractionDigits]="2"
        styleClass="w-full"
        inputStyleClass="w-full"
        required
      />
      <small class="text-muted-color">
        Enter negative amount for credit card balances
      </small>
    </div>
  </form>

  <ng-template pTemplate="footer">
    <p-button
      label="Cancel"
      icon="pi pi-times"
      (onClick)="onHide()"
      [text]="true"
      severity="secondary"
    />
    <p-button
      [label]="isEditMode ? 'Update' : 'Create'"
      icon="pi pi-check"
      (onClick)="onSubmit()"
      [loading]="loading()"
      severity="primary"
    />
  </ng-template>
</p-dialog>
